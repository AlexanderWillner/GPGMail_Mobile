<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>JavaScript Public Key Encryption</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<SCRIPT src="rsa.js"></SCRIPT>
<SCRIPT src="aes-enc.js"></SCRIPT>
<SCRIPT src="PGdecode.js"></SCRIPT>
<SCRIPT src="base64.js"></SCRIPT>
<SCRIPT src="sha1.js"></SCRIPT>
<SCRIPT src="cast5.js"></SCRIPT>

<script language="Javascript">

var dk = [256,79835921,119466303,121414380,181765629,2385002,180722037,238466499,22473911,206397250,255759451,224041648,192616279,8491175,122357715,187594198,74398690,116184881,56920272,82608358,91077291,112581838,177855197,90896813,93317939,116228988,111820677,135360813,47748600,98663351,55070804,71665024,176913722,238252034,130268354,211433517,145778876,258643440,85741786,28297295,246353531,59155769,42207752,75544410,36491651,240008166,235821070,12932226,191193096,238442510,258607869,72394155,161634708,127060471,39991388,149796968,80290816,194164237,75042546,159353412,145488291,106188858,199091193,238974861,256553683,114991543,6563953,95970601,166409906,192367873,22175884,127359,20753421,53984141,6];
var pk = [128,254811031,201598675,11086392,37809158,61736702,184194356,236048260,26579453,232422908,182950282,251968183,134212720,229356446,123241900,173837631,246810084,159108436,31954478,36926796,6861171,34369878,243581160,215446764,213256527,69929757,140133100,104426535,111793831,12792963,192939175,95971408,164249112,90432455,238829153,138543473,147177517,54322];
var qk = [128,48249849,173581060,208090803,128794725,42378432,259974304,115060649,260183401,12579304,131608989,189862248,159698743,239751369,162452152,89319153,236614211,147675411,222100612,250666875,209345238,186969937,229390904,117274963,175546932,163516074,237444684,35028363,193199635,263730770,193029745,168916055,11390613,226451583,7859714,233532882,87540907,62234];
var uk = [128,262841242,182804438,87204373,93572779,30267070,158877147,159192324,65059055,255818079,255869047,50106253,260497065,177113489,19189000,133621822,70672351,39455161,61068122,133062127,200233467,85835182,137123654,162783743,1974060,146287404,144723935,86045567,161679681,167326372,248878193,118345519,254401541,73018319,123790798,209880418,75932170,52882];
var seskey = '';

function decrypt()
{
 var startTime=new Date();

 document.t.text.value=doDecrypt(pk, qk, dk, uk, document.t.text.value);

 var endTime=new Date();
 document.t.howLong.value=(endTime.getTime()-startTime.getTime())/1000.0;
}

</script>
</HEAD>

<BODY bgcolor="#d0d0d0">
<h2 align=center>
<font color="blue">Javascript PGP/GPG packet decoder</font></h2>
<center><font size="-1">&copy; 2011 Herbert Hanewinkel</font></center>
<p>
PGP packets are internally structured by tags.
This decoder lists the tags and it's contents.
<ul>
<li>For private key decryption only CAST-128 with SHA-1 checksum
of RSA keys is implemented.</li>
<li>For message decryption only RSA and AES are implemented.</li>
</ul>
</p>
<hr>

<FORM name=t>
<table>
<tr><td colspan=2>
<p>
To decrypt a PGP message encrypted by an RSA key:
<ol>
<li>Insert the exported private key block.</li>
<li>Press Decode/Decrypt to decrypt the private key. If the key is encrypted a Password is required.</li>
<li>If the key was successfully decrypted, replace the displayed result by an encryted message.</li>
<li>Press Decode/Decrypt to decrypt the message block.</li>
</ol>
</p>
Insert an ASCII armored PGP block:<br>
<TEXTAREA name=text rows=25 cols=80></TEXTAREA>
</td></tr>
<tr>
<td align=left>
<INPUT onclick="decrypt()" type=button value="Decode/Decrypt">
</td>
<td align=right>
This took <INPUT size=4 name=howLong> seconds<BR>
</td>
</tr>
</table>
</FORM>
</body>
</html>
